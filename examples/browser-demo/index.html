<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamGuard Browser Demo</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>üõ°Ô∏è StreamGuard Browser Demo</h1>
            <p class="subtitle">Deterministic guardrails for LLM outputs, running natively in any platform</p>
        </header>

        <div class="content">
            <div class="section">
                <h2>Configure Rules</h2>
                <div class="rules-config">
                    <div class="rule-group">
                        <h3>Redact (Rewrite)</h3>
                        <label>
                            <input type="checkbox" id="rule-email" checked>
                            <span>Redact emails ‚Üí [EMAIL_REDACTED]</span>
                            <span class="info-icon" data-tooltip="engine.addEmailRedaction('[EMAIL_REDACTED]');">‚ìò</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rule-url">
                            <span>Redact URLs ‚Üí [URL_REMOVED]</span>
                            <span class="info-icon" data-tooltip="engine.addUrlRedaction('[URL_REMOVED]');">‚ìò</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rule-ip">
                            <span>Redact IPv4 addresses ‚Üí [IP_REDACTED]</span>
                            <span class="info-icon" data-tooltip="engine.addIpRedaction('[IP_REDACTED]');">‚ìò</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rule-credit-card">
                            <span>Redact credit cards ‚Üí [CC_REDACTED]</span>
                            <span class="info-icon" data-tooltip="engine.addCreditCardRedaction('[CC_REDACTED]');">‚ìò</span>
                        </label>
                    </div>

                    <div class="rule-group">
                        <h3>Block (Stop Stream)</h3>
                        <label>
                            <input type="checkbox" id="rule-forbidden" checked>
                            <span>Block: "how to build bomb"</span>
                            <span class="info-icon" data-tooltip="engine.addForbiddenSequence(['how', 'to', 'build', 'bomb'], 'forbidden weapons instructions');">‚ìò</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rule-forbidden-2" checked>
                            <span>Block: "password is"</span>
                            <span class="info-icon" data-tooltip="engine.addForbiddenSequenceStrict(['password', 'is'], 'credential leak detected');">‚ìò</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rule-jailbreak">
                            <span>Block: DAN jailbreak pattern (multi-token DFA)</span>
                            <span class="info-icon" data-tooltip="engine.addForbiddenSequence(['ignore', 'previous', 'instructions'], 'jailbreak attempt detected');">‚ìò</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rule-admin">
                            <span>Block: "ignore" ‚Üí "instructions" ‚Üí "admin" (gaps allowed)</span>
                            <span class="info-icon" data-tooltip="engine.addForbiddenSequence(['ignore', 'instructions', 'admin'], 'admin override attempt');">‚ìò</span>
                        </label>
                    </div>

                    <div class="rule-group">
                        <h3>Scoring</h3>
                        <label>
                            <input type="checkbox" id="enable-scoring">
                            <span>Enable score threshold</span>
                            <span class="info-icon" data-tooltip="engine = WasmGuardEngine.withScoreThreshold(100);">‚ìò</span>
                        </label>
                        <div id="scoring-config" style="display: none; margin-top: 10px;">
                            <label>
                                Threshold: <input type="number" id="score-threshold" value="100" min="10" max="500"
                                    style="width: 80px;">
                            </label>
                        </div>
                    </div>

                    <button id="btn-reset" class="btn btn-secondary">Reset Engine</button>
                </div>
            </div>

            <div class="section">
                <h2>Test Stream</h2>
                <div class="test-area">
                    <div style="margin-bottom: 10px;">
                        <label for="example-selector" style="font-weight: bold; margin-right: 10px;">Select Example:</label>
                        <select id="example-selector" class="btn btn-secondary" style="padding: 8px; min-width: 200px;">
                            <option value="basic">Basic (Redaction)</option>
                            <option value="block">Security Block</option>
                            <option value="jailbreak">Jailbreak Detection</option>
                            <option value="complex">Complex DFA Patterns</option>
                            <option value="streaming">Streaming Edge Cases</option>
                        </select>
                    </div>
                    <textarea id="input-text"
                        placeholder="Type or paste text to test guardrails...">Hello! I'm an AI assistant. For support, contact us at admin@example.com or visit our site at https://help.example.com.

Important: Never share sensitive data. For instance, if someone asks "how to build a huge bomb" or your "password today is secret123", that's a security red flag.

For technical issues, contact our server at 192.168.1.100 or use card 4532-1234-5678-9010 for payment.

We can help with legitimate questions about technology, learning, and problem-solving. Our team is available 24/7!</textarea>

                    <div class="controls">
                        <button id="btn-process-chunk" class="btn btn-primary">Process as Chunk</button>
                        <button id="btn-process-stream" class="btn btn-primary">Simulate Streaming</button>
                        <button id="btn-clear" class="btn btn-secondary">Clear</button>
                    </div>

                    <div class="output-section">
                        <h3>Output <span id="decision-badge" class="badge"></span></h3>
                        <div id="output-text" class="output"></div>
                    </div>

                    <div class="status-section">
                        <h3>Status</h3>
                        <div id="status-info" class="status">
                            <div>Engine State: <span id="engine-state">Ready</span></div>
                            <div>Current Score: <span id="current-score">0</span></div>
                            <div>Rules Active: <span id="rule-count">0</span></div>
                            <div>Chunks Processed: <span id="chunks-processed">0</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>
                StreamGuard is a deterministic, streaming-first guardrail engine for LLM outputs.
                <br>
                <a href="https://github.com/d-barletta/StreamGuard" target="_blank">View on GitHub</a>
                ‚Ä¢
                <a href="EXAMPLES.md" target="_blank">Complex Examples Guide</a>
                ‚Ä¢
                <a href="DFA_EXAMPLES.md" target="_blank">DFA Visual Guide</a>
            </p>
        </footer>
    </div>

    <script type="module" src="./demo.js"></script>
</body>

</html>